<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>JSmol 分子点群交互演示</title>

<script src="jsmol/JSmol.min.js"></script>

<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  background: #f6f7f9;
  text-align: center;
}

h2 {
  margin-top: 15px;
}

.panel {
  background: #ffffff;
  border-radius: 10px;
  padding: 10px;
  margin: 10px auto;
  width: 90%;
  max-width: 900px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

button {
  margin: 4px;
  padding: 6px 14px;
  font-size: 14px;
  border-radius: 6px;
  border: 1px solid #ccc;
  cursor: pointer;
  background: #fdfdfd;
}

button:hover {
  background: #e9eef5;
}

#viewer {
  width: 420px;
  height: 420px;
  margin: 15px auto;
  border: 1px solid #bbb;
  background: white;
}

.hidden {
  display: none;
}
</style>
</head>

<body>

<h2>分子点群 Cₙ 操作演示（JSmol）</h2>
<div class="panel">
  <strong>选择分子</strong><br>

  <button onclick="selectMol('water.xyz', [2])">H₂O</button>
  <button onclick="selectMol('h2o2.mol', [2])">H₂O₂</button>

  <button onclick="selectMol('C2H2Cl2.mol', [2])">C₂H₂Cl₂</button>
  <button onclick="selectMol('CHCl3.mol', [3])">CHCl₃</button>

  <button onclick="selectMol('ClHC=C=CHCl.mol', [2])">ClHC=C=CHCl</button>
  <button onclick="selectMol('h3c-ccl3.mol', [3])">CH₃–CCl₃</button>

  <button onclick="selectMol('CO2.mol', [2])">CO₂</button>
  <button onclick="selectMol('BF3.mol', [3])">BF₃</button>

  <button onclick="selectMol('C6H6.mol', [6,3,2])">C₆H₆</button>
  <button onclick="selectMol('H2C=CH2.mol', [2])">H₂C=CH₂</button>

  <button onclick="selectMol('H2CCCH2.mol', [2])">H₂CCCH₂</button>
  <button onclick="selectMol('PtCl4(e2-).mol', [4,2])">PtCl₄²⁻</button>

  <button onclick="selectMol('SbCl5(e2-).mol', [5])">SbCl₅²⁻</button>
</div>

<!-- ================= 点群操作 ================= -->
<div class="panel">
  <strong>可用对称操作（仅该分子允许的）</strong><br>

  <button id="btnC2" class="hidden" onclick="doCn(2)">C₂</button>
  <button id="btnC3" class="hidden" onclick="doCn(3)">C₃</button>
  <button id="btnC4" class="hidden" onclick="doCn(4)">C₄</button>
  <button id="btnC5" class="hidden" onclick="doCn(5)">C₅</button>
  <button id="btnC6" class="hidden" onclick="doCn(6)">C₆</button>
</div>

<div id="viewer"></div>

<script>
Jmol.setDocument(0);

var Info = {
  width: 420,
  height: 420,
  use: "HTML5",
  j2sPath: "jsmol/j2s",
  backgroundColor: "white",
  script: "set antialiasDisplay; set zoomLarge false;"
};

var myJmol = Jmol.getApplet("myJmol", Info);
document.getElementById("viewer").innerHTML =
  Jmol.getAppletHtml(myJmol);

/* ========= 当前分子支持的 Cn ========= */
var currentCn = [];

/* ========= 选择分子 ========= */
function selectMol(file, cnList) {

  currentCn = cnList;

  Jmol.script(myJmol, `
    load ${file}
    center
    zoom 120
    spin off
    calculate pointgroup
    draw pointgroup
  `);

  updateButtons();
}

/* ========= 更新按钮显示 ========= */
function updateButtons() {
  [2,3,4,5,6].forEach(n => {
    document.getElementById("btnC"+n).classList.add("hidden");
  });

  currentCn.forEach(n => {
    document.getElementById("btnC"+n).classList.remove("hidden");
  });
}

/* ========= 执行 Cn ========= */
function doCn(n) {
  var angle = 360 / n;
  Jmol.script(myJmol, `
    spin $pgva_0_c${n}_1 ${angle} 60
  `);
}
</script>

</body>
</html>

